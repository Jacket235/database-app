{"ast":null,"code":"import _objectSpread from\"X:/Other/Coding/React/database-app/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import{useState}from\"react\";import modifyEvents from\"../functions/modifyEvents\";import{useAuth}from\"../context/AuthContext\";import modifyConnections from\"../functions/modifyConnections\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";export default function ManageTimelineModal(_ref){var _selectedEvent$id;let{show,onClose,events,setEvents,connections,setConnections}=_ref;const[activeTab,setActiveTab]=useState(\"events\");const[selectedStep,setSelectedStep]=useState(-1);const[selectedEvent,setSelectedEvent]=useState();const[tempEvents,setTempEvents]=useState(events);const[tempConnections,setTempConnections]=useState(connections);const[draggedEventId,setDraggedEventId]=useState(null);const{accessToken}=useAuth();if(!show)return null;function checkForEventMods(original,updated){const originalMap=new Map(original.map(e=>[e.id,e]));const updatedMap=new Map(updated.map(e=>[e.id,e]));const added=[];const modified=[];const removed=[];// Check added & modified\nfor(const updatedEvent of updated){const originalEvent=originalMap.get(updatedEvent.id);if(!originalEvent){added.push(updatedEvent);// new event\n}else if(updatedEvent.name!==originalEvent.name||updatedEvent.step_id!==originalEvent.step_id||updatedEvent.position!==originalEvent.position){modified.push(updatedEvent);// changed event\n}}// Check removed\nfor(const originalEvent of original){if(!updatedMap.has(originalEvent.id)){removed.push(originalEvent);}}return{added,modified,removed};}function checkForConnectionMods(original,updated){const originalSet=new Set(original.map(conn=>\"\".concat(conn.from_event_id,\"->\").concat(conn.to_event_id)));const updatedSet=new Set(updated.map(conn=>\"\".concat(conn.from_event_id,\"->\").concat(conn.to_event_id)));const connected=Array.from(updatedSet).filter(key=>!originalSet.has(key)).map(key=>{const[from,to]=key.split(\"->\").map(Number);return{from_event_id:from,to_event_id:to};});const disconnected=Array.from(originalSet).filter(key=>!updatedSet.has(key)).map(key=>{const[from,to]=key.split(\"->\").map(Number);return{from_event_id:from,to_event_id:to};});return{connected,disconnected};}return/*#__PURE__*/_jsx(\"div\",{className:\"modal d-block\",tabIndex:-1,style:{backgroundColor:'rgba(0,0,0,0.5)'},children:/*#__PURE__*/_jsx(\"div\",{className:\"modal-dialog\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-header\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"modal-title\",children:\"Manage your timeline\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn-close\",onClick:()=>onClose()})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-body\",children:[/*#__PURE__*/_jsxs(\"ul\",{className:\"nav nav-tabs mb-3\",children:[/*#__PURE__*/_jsx(\"li\",{className:\"nav-item\",children:/*#__PURE__*/_jsx(\"button\",{className:\"nav-link \".concat(activeTab===\"events\"?\"active\":\"\"),onClick:()=>setActiveTab(\"events\"),children:\"Modify Events\"})}),/*#__PURE__*/_jsx(\"li\",{className:\"nav-item\",children:/*#__PURE__*/_jsx(\"button\",{className:\"nav-link \".concat(activeTab===\"connections\"?\"active\":\"\"),onClick:()=>setActiveTab(\"connections\"),children:\"Modify Connections\"})})]}),activeTab===\"events\"&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-floating mb-3\",children:[/*#__PURE__*/_jsxs(\"select\",{className:\"form-select\",value:selectedStep!==null&&selectedStep!==void 0?selectedStep:-1,onChange:e=>setSelectedStep(Number(e.target.value)),children:[/*#__PURE__*/_jsx(\"option\",{value:\"-1\",children:\"Step\"}),[0,1,2,3].map(i=>/*#__PURE__*/_jsx(\"option\",{value:i,children:i+1},i))]}),/*#__PURE__*/_jsx(\"label\",{children:\"Select the step to modify\"})]}),selectedStep!==-1&&/*#__PURE__*/_jsx(\"div\",{className:\"mb-3 d-flex flex-column\",children:selectedStep!==-1&&tempEvents.filter(e=>e.step_id===selectedStep).sort((a,b)=>a.position-b.position).map(event=>/*#__PURE__*/_jsxs(\"div\",{className:\"border rounded p-1 my-1 d-flex justify-content-between align-items-center\",draggable:true,style:{cursor:\"move\"},onDragStart:()=>setDraggedEventId(event.id),onDragOver:e=>e.preventDefault(),onDrop:()=>{if(draggedEventId===null||draggedEventId===event.id)return;const draggedIndex=tempEvents.findIndex(e=>e.id===draggedEventId);const dropIndex=tempEvents.findIndex(e=>e.id===event.id);const updated=[...tempEvents];const[movedItem]=updated.splice(draggedIndex,1);updated.splice(dropIndex,0,movedItem);const stepEvents=updated.filter(e=>e.step_id===selectedStep);const otherEvents=updated.filter(e=>e.step_id!==selectedStep);const reordered=stepEvents.map((e,i)=>_objectSpread(_objectSpread({},e),{},{position:i}));setTempEvents([...otherEvents,...reordered]);},children:[/*#__PURE__*/_jsx(\"input\",{className:\"form-control no-outline\",value:event.name,onChange:e=>{const updated=tempEvents.map(ev=>ev.id===event.id?_objectSpread(_objectSpread({},ev),{},{name:e.target.value}):ev);setTempEvents(updated);}}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-danger\",onClick:()=>{const updated=tempEvents.filter(e=>e.id!==event.id);const stepEvents=updated.filter(e=>e.step_id===selectedStep);const otherEvents=updated.filter(e=>e.step_id!==selectedStep);const reordered=stepEvents.map((e,i)=>_objectSpread(_objectSpread({},e),{},{position:i}));setTempEvents([...otherEvents,...reordered]);},children:\"Remove\"})]},event.id))}),/*#__PURE__*/_jsx(\"div\",{className:\"mb-1\",children:selectedStep!==-1&&/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-success\",onClick:()=>{if(selectedStep==null)return;const stepEvents=tempEvents.filter(e=>e.step_id===selectedStep);const newEvent={id:-Date.now(),name:\"New Event\",step_id:selectedStep,position:stepEvents.length};setTempEvents([...tempEvents,newEvent]);},children:\"Add Event\"})})]}),activeTab===\"connections\"&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-floating mb-3\",children:[/*#__PURE__*/_jsxs(\"select\",{className:\"form-select\",value:(_selectedEvent$id=selectedEvent===null||selectedEvent===void 0?void 0:selectedEvent.id)!==null&&_selectedEvent$id!==void 0?_selectedEvent$id:-1,onChange:e=>{const id=Number(e.target.value);const selected=tempEvents.find(eve=>eve.id===id);setSelectedEvent(selected);},children:[/*#__PURE__*/_jsx(\"option\",{value:\"-1\",children:\"Select event\"}),tempEvents.map(event=>/*#__PURE__*/_jsx(\"option\",{value:event.id,children:event.name},event.id))]}),/*#__PURE__*/_jsx(\"label\",{children:\"Select an event in your timeline\"})]}),selectedEvent&&/*#__PURE__*/_jsx(\"div\",{className:\"mb-3 d-flex flex-column\",children:tempEvents.filter(e=>e.step_id>selectedEvent.step_id).map(event=>{const isConnected=tempConnections.some(conn=>conn.from_event_id===selectedEvent.id&&conn.to_event_id===event.id);return/*#__PURE__*/_jsxs(\"div\",{className:\"border rounded p-1 my-1 d-flex justify-content-between align-items-center\",children:[event.name,/*#__PURE__*/_jsx(\"button\",{className:\"btn \".concat(isConnected?\"btn-outline-danger\":\"btn-outline-primary\"),onClick:()=>{if(isConnected){setTempConnections(prev=>prev.filter(conn=>!(conn.from_event_id===selectedEvent.id&&conn.to_event_id===event.id)));}else{setTempConnections(prev=>[...prev,{from_event_id:selectedEvent.id,to_event_id:event.id}]);}},children:isConnected?\"Disconnect\":\"Connect\"})]},event.id);})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-footer\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-primary\",onClick:async()=>{try{const{added,modified,removed}=checkForEventMods(events,tempEvents);const{connected,disconnected}=checkForConnectionMods(connections,tempConnections);console.log(\"Sending EVENTS...\");const resEvents=await modifyEvents(accessToken,added,modified,removed);console.log(\"EVENTS response:\",resEvents);console.log(\"Sending CONNECTIONS...\");const resConnections=await modifyConnections(accessToken,connected,disconnected);console.log(\"CONNECTIONS response:\",resConnections);setEvents(tempEvents);setConnections(tempConnections);onClose();}catch(err){console.error(\"Save failed:\",err);}},children:\"Save\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-danger\",onClick:()=>onClose(),children:\"Cancel\"})]})]})})});}","map":{"version":3,"names":["useState","modifyEvents","useAuth","modifyConnections","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","ManageTimelineModal","_ref","_selectedEvent$id","show","onClose","events","setEvents","connections","setConnections","activeTab","setActiveTab","selectedStep","setSelectedStep","selectedEvent","setSelectedEvent","tempEvents","setTempEvents","tempConnections","setTempConnections","draggedEventId","setDraggedEventId","accessToken","checkForEventMods","original","updated","originalMap","Map","map","e","id","updatedMap","added","modified","removed","updatedEvent","originalEvent","get","push","name","step_id","position","has","checkForConnectionMods","originalSet","Set","conn","concat","from_event_id","to_event_id","updatedSet","connected","Array","from","filter","key","to","split","Number","disconnected","className","tabIndex","style","backgroundColor","children","onClick","value","onChange","target","i","sort","a","b","event","draggable","cursor","onDragStart","onDragOver","preventDefault","onDrop","draggedIndex","findIndex","dropIndex","movedItem","splice","stepEvents","otherEvents","reordered","_objectSpread","ev","newEvent","Date","now","length","selected","find","eve","isConnected","some","prev","console","log","resEvents","resConnections","err","error"],"sources":["X:/Other/Coding/React/database-app/frontend/src/components/ManageTimelineModal.tsx"],"sourcesContent":["import { SetStateAction, Dispatch, useState } from \"react\";\r\nimport modifyEvents from \"../functions/modifyEvents\";\r\nimport { useAuth } from \"../context/AuthContext\";\r\nimport modifyConnections from \"../functions/modifyConnections\";\r\n\r\ninterface Event {\r\n    id: number;\r\n    name: string;\r\n    step_id: number;\r\n    position: number;\r\n}\r\n\r\ninterface Connection {\r\n    from_event_id: number,       // Event ID from\r\n    to_event_id: number          // Event ID to\r\n}\r\n\r\ninterface Props {\r\n    show: boolean;\r\n    onClose: () => void;\r\n    events: Event[];\r\n    setEvents: Dispatch<SetStateAction<Event[]>>;\r\n    connections: Connection[];\r\n    setConnections: Dispatch<SetStateAction<Connection[]>>;\r\n}\r\n\r\nexport default function ManageTimelineModal({ show, onClose, events, setEvents, connections, setConnections }: Props) {\r\n    const [activeTab, setActiveTab] = useState<\"events\" | \"connections\">(\"events\");\r\n    const [selectedStep, setSelectedStep] = useState<number>(-1);\r\n    const [selectedEvent, setSelectedEvent] = useState<Event>();\r\n    const [tempEvents, setTempEvents] = useState(events);\r\n    const [tempConnections, setTempConnections] = useState<Connection[]>(connections);\r\n    const [draggedEventId, setDraggedEventId] = useState<number | null>(null);\r\n    const { accessToken } = useAuth();\r\n\r\n    if (!show) return null;\r\n\r\n    interface EventChanges {\r\n        added: Event[];\r\n        modified: Event[];\r\n        removed: Event[];\r\n    }\r\n\r\n    function checkForEventMods(original: Event[], updated: Event[]): EventChanges {\r\n        const originalMap = new Map(original.map(e => [e.id, e]));\r\n        const updatedMap = new Map(updated.map(e => [e.id, e]));\r\n\r\n        const added: Event[] = [];\r\n        const modified: Event[] = [];\r\n        const removed: Event[] = [];\r\n\r\n        // Check added & modified\r\n        for (const updatedEvent of updated) {\r\n            const originalEvent = originalMap.get(updatedEvent.id);\r\n            if (!originalEvent) {\r\n                added.push(updatedEvent); // new event\r\n            } else if (\r\n                updatedEvent.name !== originalEvent.name ||\r\n                updatedEvent.step_id !== originalEvent.step_id ||\r\n                updatedEvent.position !== originalEvent.position\r\n            ) {\r\n                modified.push(updatedEvent); // changed event\r\n            }\r\n        }\r\n\r\n        // Check removed\r\n        for (const originalEvent of original) {\r\n            if (!updatedMap.has(originalEvent.id)) {\r\n                removed.push(originalEvent);\r\n            }\r\n        }\r\n\r\n        return { added, modified, removed };\r\n    }\r\n\r\n    function checkForConnectionMods(original: Connection[], updated: Connection[]) {\r\n        const originalSet = new Set(original.map(conn => `${conn.from_event_id}->${conn.to_event_id}`));\r\n        const updatedSet = new Set(updated.map(conn => `${conn.from_event_id}->${conn.to_event_id}`));\r\n\r\n        const connected = Array.from(updatedSet)\r\n            .filter(key => !originalSet.has(key))\r\n            .map(key => {\r\n                const [from, to] = key.split(\"->\").map(Number);\r\n                return { from_event_id: from, to_event_id: to };\r\n            });\r\n\r\n        const disconnected = Array.from(originalSet)\r\n            .filter(key => !updatedSet.has(key))\r\n            .map(key => {\r\n                const [from, to] = key.split(\"->\").map(Number);\r\n                return { from_event_id: from, to_event_id: to };\r\n            });\r\n\r\n\r\n        return { connected, disconnected };\r\n    }\r\n\r\n    return (\r\n        <div className=\"modal d-block\" tabIndex={-1} style={{ backgroundColor: 'rgba(0,0,0,0.5)' }}>\r\n            <div className=\"modal-dialog\">\r\n                <div className=\"modal-content\">\r\n                    <div className=\"modal-header\">\r\n                        <h5 className=\"modal-title\">Manage your timeline</h5>\r\n                        <button className=\"btn-close\" onClick={() => onClose()}></button>\r\n                    </div>\r\n                    <div className=\"modal-body\">\r\n                        <ul className=\"nav nav-tabs mb-3\">\r\n                            <li className=\"nav-item\">\r\n                                <button\r\n                                    className={`nav-link ${activeTab === \"events\" ? \"active\" : \"\"}`}\r\n                                    onClick={() => setActiveTab(\"events\")}\r\n                                >\r\n                                    Modify Events\r\n                                </button>\r\n                            </li>\r\n                            <li className=\"nav-item\">\r\n                                <button\r\n                                    className={`nav-link ${activeTab === \"connections\" ? \"active\" : \"\"}`}\r\n                                    onClick={() => setActiveTab(\"connections\")}\r\n                                >\r\n                                    Modify Connections\r\n                                </button>\r\n                            </li>\r\n                        </ul>\r\n\r\n                        {activeTab === \"events\" && (\r\n                            <>\r\n                                <div className=\"form-floating mb-3\">\r\n                                    <select className=\"form-select\" value={selectedStep ?? -1} onChange={(e) => setSelectedStep(Number(e.target.value))}>\r\n                                        <option value=\"-1\">Step</option>\r\n                                        {[0, 1, 2, 3].map(i => (\r\n                                            <option key={i} value={i}>{i + 1}</option>\r\n                                        ))}\r\n                                    </select>\r\n                                    <label>Select the step to modify</label>\r\n                                </div>\r\n                                {selectedStep !== -1 && (\r\n                                    <div className=\"mb-3 d-flex flex-column\">\r\n                                        {selectedStep !== -1 && tempEvents\r\n                                            .filter(e => e.step_id === selectedStep)\r\n                                            .sort((a, b) => a.position - b.position)\r\n                                            .map(event => (\r\n                                                <div\r\n                                                    key={event.id}\r\n                                                    className=\"border rounded p-1 my-1 d-flex justify-content-between align-items-center\"\r\n                                                    draggable\r\n                                                    style={{ cursor: \"move\" }}\r\n                                                    onDragStart={() => setDraggedEventId(event.id)}\r\n                                                    onDragOver={e => e.preventDefault()}\r\n                                                    onDrop={() => {\r\n                                                        if (draggedEventId === null || draggedEventId === event.id) return;\r\n\r\n                                                        const draggedIndex = tempEvents.findIndex(e => e.id === draggedEventId);\r\n                                                        const dropIndex = tempEvents.findIndex(e => e.id === event.id);\r\n                                                        const updated = [...tempEvents];\r\n                                                        const [movedItem] = updated.splice(draggedIndex, 1);\r\n                                                        updated.splice(dropIndex, 0, movedItem);\r\n\r\n                                                        const stepEvents = updated.filter(e => e.step_id === selectedStep);\r\n                                                        const otherEvents = updated.filter(e => e.step_id !== selectedStep);\r\n                                                        const reordered = stepEvents.map((e, i) => ({ ...e, position: i }));\r\n\r\n                                                        setTempEvents([...otherEvents, ...reordered]);\r\n                                                    }}\r\n                                                >\r\n                                                    {/* {event.name} */}\r\n                                                    <input\r\n                                                        className=\"form-control no-outline\"\r\n                                                        value={event.name}\r\n                                                        onChange={(e) => {\r\n                                                            const updated = tempEvents.map(ev => ev.id === event.id ? { ...ev, name: e.target.value } : ev);\r\n                                                            setTempEvents(updated)\r\n                                                        }}\r\n                                                    />\r\n                                                    <button\r\n                                                        className=\"btn btn-danger\"\r\n                                                        onClick={() => {\r\n                                                            const updated = tempEvents.filter(e => e.id !== event.id);\r\n                                                            const stepEvents = updated.filter(e => e.step_id === selectedStep);\r\n                                                            const otherEvents = updated.filter(e => e.step_id !== selectedStep);\r\n                                                            const reordered = stepEvents.map((e, i) => ({ ...e, position: i }));\r\n                                                            setTempEvents([...otherEvents, ...reordered]);\r\n                                                        }}>\r\n                                                        Remove\r\n                                                    </button>\r\n                                                </div>\r\n                                            ))}\r\n                                    </div>\r\n                                )}\r\n                                <div className=\"mb-1\">\r\n                                    {selectedStep !== -1 && (\r\n                                        <button className=\"btn btn-success\" onClick={() => {\r\n                                            if (selectedStep == null) return;\r\n\r\n                                            const stepEvents = tempEvents.filter(e => e.step_id === selectedStep);\r\n                                            const newEvent = {\r\n                                                id: -Date.now(),\r\n                                                name: \"New Event\",\r\n                                                step_id: selectedStep,\r\n                                                position: stepEvents.length\r\n                                            };\r\n                                            setTempEvents([...tempEvents, newEvent]);\r\n                                        }}>\r\n                                            Add Event\r\n                                        </button>\r\n                                    )}\r\n                                </div>\r\n                            </>\r\n                        )}\r\n                        {activeTab === \"connections\" && (\r\n                            <>\r\n                                <div className=\"form-floating mb-3\">\r\n                                    <select className=\"form-select\"\r\n                                        value={selectedEvent?.id ?? -1}\r\n                                        onChange={e => {\r\n                                            const id = Number(e.target.value);\r\n                                            const selected = tempEvents.find(eve => eve.id === id)\r\n                                            setSelectedEvent(selected);\r\n                                        }}>\r\n                                        <option value=\"-1\">Select event</option>\r\n                                        {tempEvents.map(event => (\r\n                                            <option key={event.id} value={event.id}>{event.name}</option>\r\n                                        ))}\r\n                                    </select>\r\n                                    <label>Select an event in your timeline</label>\r\n                                </div>\r\n                                {selectedEvent && (\r\n                                    <div className=\"mb-3 d-flex flex-column\">\r\n                                        {tempEvents\r\n                                            .filter(e => e.step_id > selectedEvent.step_id)\r\n                                            .map(event => {\r\n                                                const isConnected = tempConnections.some(conn =>\r\n                                                    conn.from_event_id === selectedEvent.id &&\r\n                                                    conn.to_event_id === event.id\r\n                                                );\r\n\r\n                                                return (\r\n                                                    <div\r\n                                                        key={event.id}\r\n                                                        className=\"border rounded p-1 my-1 d-flex justify-content-between align-items-center\"\r\n                                                    >\r\n                                                        {event.name}\r\n                                                        <button\r\n                                                            className={`btn ${isConnected ? \"btn-outline-danger\" : \"btn-outline-primary\"}`}\r\n                                                            onClick={() => {\r\n                                                                if (isConnected) {\r\n                                                                    setTempConnections(prev =>\r\n                                                                        prev.filter(conn => !(\r\n                                                                            conn.from_event_id === selectedEvent.id &&\r\n                                                                            conn.to_event_id === event.id\r\n                                                                        ))\r\n                                                                    );\r\n                                                                } else {\r\n                                                                    setTempConnections(prev => [...prev, {\r\n                                                                        from_event_id: selectedEvent.id,\r\n                                                                        to_event_id: event.id,\r\n                                                                    }]);\r\n                                                                }\r\n                                                            }}>\r\n                                                            {isConnected ? \"Disconnect\" : \"Connect\"}\r\n                                                        </button>\r\n                                                    </div>\r\n                                                );\r\n                                            })}\r\n                                    </div>\r\n                                )}\r\n                            </>\r\n                        )}\r\n                    </div>\r\n                    <div className=\"modal-footer\">\r\n                        <button\r\n                            className=\"btn btn-primary\"\r\n                            onClick={async () => {\r\n                                try {\r\n                                    const { added, modified, removed } = checkForEventMods(events, tempEvents);\r\n                                    const { connected, disconnected } = checkForConnectionMods(connections, tempConnections);\r\n\r\n                                    console.log(\"Sending EVENTS...\");\r\n                                    const resEvents = await modifyEvents(accessToken, added, modified, removed);\r\n                                    console.log(\"EVENTS response:\", resEvents);\r\n\r\n                                    console.log(\"Sending CONNECTIONS...\");\r\n                                    const resConnections = await modifyConnections(accessToken, connected, disconnected);\r\n                                    console.log(\"CONNECTIONS response:\", resConnections);\r\n\r\n                                    setEvents(tempEvents);\r\n                                    setConnections(tempConnections);\r\n                                    onClose();\r\n                                } catch (err) {\r\n                                    console.error(\"Save failed:\", err);\r\n                                }\r\n                            }}\r\n                        >\r\n                            Save\r\n                        </button>\r\n                        <button className=\"btn btn-danger\" onClick={() => onClose()}>\r\n                            Cancel\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div >\r\n    );\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}