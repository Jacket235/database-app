{"ast":null,"code":"import _objectSpread from\"X:/Other/Coding/React/database-app/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React from'react';import{useEffect,useState}from'react';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function ManageEventsModal(_ref){let{show,onClose,events,setEvents,selectedStep,setSelectedStep}=_ref;const[tempEvents,setTempEvents]=useState(events);const[draggedEventId,setDraggedEventId]=useState(null);useEffect(()=>{if(show)setTempEvents(events);},[show,events]);if(!show)return null;return/*#__PURE__*/_jsx(\"div\",{className:\"modal d-block\",tabIndex:-1,style:{backgroundColor:'rgba(0,0,0,0.5)'},children:/*#__PURE__*/_jsx(\"div\",{className:\"modal-dialog\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-header\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"modal-title\",children:\"Manage your timeline\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn-close\",onClick:onClose})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-body\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"mb-3 d-flex flex-column\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"form-floating\",children:[/*#__PURE__*/_jsxs(\"select\",{className:\"form-select\",value:selectedStep!==null&&selectedStep!==void 0?selectedStep:'',onChange:e=>setSelectedStep(Number(e.target.value)),children:[/*#__PURE__*/_jsx(\"option\",{defaultValue:\"\",children:\"Step\"}),[0,1,2,3].map(i=>/*#__PURE__*/_jsx(\"option\",{value:i,children:i+1},i))]}),/*#__PURE__*/_jsx(\"label\",{children:\"Select the step to modify\"})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"mb-3 d-flex flex-column\",children:selectedStep!==null&&tempEvents.filter(e=>e.step_id===selectedStep).sort((a,b)=>a.position-b.position).map(event=>/*#__PURE__*/_jsxs(\"div\",{className:\"border rounded p-1 my-1 d-flex justify-content-between align-items-center\",draggable:true,style:{cursor:\"move\"},onDragStart:()=>setDraggedEventId(event.id),onDragOver:e=>e.preventDefault(),onDrop:()=>{if(draggedEventId===null||draggedEventId===event.id)return;const draggedIndex=tempEvents.findIndex(e=>e.id===draggedEventId);const dropIndex=tempEvents.findIndex(e=>e.id===event.id);const updated=[...tempEvents];const[movedItem]=updated.splice(draggedIndex,1);updated.splice(dropIndex,0,movedItem);const stepEvents=updated.filter(e=>e.step_id===selectedStep);const otherEvents=updated.filter(e=>e.step_id!==selectedStep);const reordered=stepEvents.map((e,i)=>_objectSpread(_objectSpread({},e),{},{position:i}));setTempEvents([...otherEvents,...reordered]);},children:[/*#__PURE__*/_jsx(\"span\",{children:event.name}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-danger\",onClick:()=>{const updated=tempEvents.filter(e=>e.id!==event.id);const stepEvents=updated.filter(e=>e.step_id===selectedStep);const otherEvents=updated.filter(e=>e.step_id!==selectedStep);const reordered=stepEvents.map((e,i)=>_objectSpread(_objectSpread({},e),{},{position:i}));setTempEvents([...otherEvents,...reordered]);},children:\"Remove\"})]},event.id))}),selectedStep!==null&&/*#__PURE__*/_jsx(\"div\",{className:\"mb-1\",children:/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-success\",onClick:()=>{const stepEvents=tempEvents.filter(e=>e.step_id===selectedStep);const newEvent={id:-Date.now(),name:\"New Event\",step_id:selectedStep,position:stepEvents.length};setTempEvents([...tempEvents,newEvent]);},children:\"Add event\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-footer\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-primary\",onClick:()=>{setEvents(tempEvents);onClose();},children:\"Save\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-danger\",onClick:onClose,children:\"Cancel\"})]})]})})});}","map":{"version":3,"names":["React","useEffect","useState","jsx","_jsx","jsxs","_jsxs","ManageEventsModal","_ref","show","onClose","events","setEvents","selectedStep","setSelectedStep","tempEvents","setTempEvents","draggedEventId","setDraggedEventId","className","tabIndex","style","backgroundColor","children","onClick","value","onChange","e","Number","target","defaultValue","map","i","filter","step_id","sort","a","b","position","event","draggable","cursor","onDragStart","id","onDragOver","preventDefault","onDrop","draggedIndex","findIndex","dropIndex","updated","movedItem","splice","stepEvents","otherEvents","reordered","_objectSpread","name","newEvent","Date","now","length"],"sources":["X:/Other/Coding/React/database-app/frontend/src/components/manageEventsModal.tsx"],"sourcesContent":["import React from 'react';\r\n\r\nimport { useEffect, useState, SetStateAction, Dispatch } from 'react';\r\n\r\ninterface Event {\r\n    id: number;\r\n    name: string;\r\n    step_id: number;\r\n    position: number;\r\n}\r\n\r\ninterface Props {\r\n    show: boolean;\r\n    onClose: () => void;\r\n    events: Event[];\r\n    setEvents: Dispatch<SetStateAction<Event[]>>;\r\n    selectedStep: number | null;\r\n    setSelectedStep: Dispatch<SetStateAction<number | null>>;\r\n}\r\n\r\nexport default function ManageEventsModal({\r\n    show,\r\n    onClose,\r\n    events,\r\n    setEvents,\r\n    selectedStep,\r\n    setSelectedStep\r\n}: Props) {\r\n    const [tempEvents, setTempEvents] = useState(events);\r\n    const [draggedEventId, setDraggedEventId] = useState<number | null>(null);\r\n\r\n    useEffect(() => {\r\n        if (show) setTempEvents(events);\r\n    }, [show, events]);\r\n\r\n    if (!show) return null;\r\n\r\n    return (\r\n        <div className=\"modal d-block\" tabIndex={-1} style={{ backgroundColor: 'rgba(0,0,0,0.5)' }}>\r\n            <div className=\"modal-dialog\">\r\n                <div className=\"modal-content\">\r\n                    <div className=\"modal-header\">\r\n                        <h5 className=\"modal-title\">Manage your timeline</h5>\r\n                        <button className=\"btn-close\" onClick={onClose}></button>\r\n                    </div>\r\n                    <div className=\"modal-body\">\r\n                        <div className=\"mb-3 d-flex flex-column\">\r\n                            <div className=\"form-floating\">\r\n                                <select className=\"form-select\" value={selectedStep ?? ''} onChange={(e) => setSelectedStep(Number(e.target.value))}>\r\n                                    <option defaultValue=\"\">Step</option>\r\n                                    {[0, 1, 2, 3].map(i => (\r\n                                        <option key={i} value={i}>{i + 1}</option>\r\n                                    ))}\r\n                                </select>\r\n                                <label>Select the step to modify</label>\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"mb-3 d-flex flex-column\">\r\n                            {selectedStep !== null && tempEvents\r\n                                .filter(e => e.step_id === selectedStep)\r\n                                .sort((a, b) => a.position - b.position)\r\n                                .map(event => (\r\n                                    <div\r\n                                        key={event.id}\r\n                                        className=\"border rounded p-1 my-1 d-flex justify-content-between align-items-center\"\r\n                                        draggable\r\n                                        style={{ cursor: \"move\" }}\r\n                                        onDragStart={() => setDraggedEventId(event.id)}\r\n                                        onDragOver={e => e.preventDefault()}\r\n                                        onDrop={() => {\r\n                                            if (draggedEventId === null || draggedEventId === event.id) return;\r\n\r\n                                            const draggedIndex = tempEvents.findIndex(e => e.id === draggedEventId);\r\n                                            const dropIndex = tempEvents.findIndex(e => e.id === event.id);\r\n                                            const updated = [...tempEvents];\r\n                                            const [movedItem] = updated.splice(draggedIndex, 1);\r\n                                            updated.splice(dropIndex, 0, movedItem);\r\n\r\n                                            const stepEvents = updated.filter(e => e.step_id === selectedStep);\r\n                                            const otherEvents = updated.filter(e => e.step_id !== selectedStep);\r\n                                            const reordered = stepEvents.map((e, i) => ({ ...e, position: i }));\r\n\r\n                                            setTempEvents([...otherEvents, ...reordered]);\r\n                                        }}\r\n                                    >\r\n                                        <span>{event.name}</span>\r\n                                        <button\r\n                                            className=\"btn btn-danger\"\r\n                                            onClick={() => {\r\n                                                const updated = tempEvents.filter(e => e.id !== event.id);\r\n                                                const stepEvents = updated.filter(e => e.step_id === selectedStep);\r\n                                                const otherEvents = updated.filter(e => e.step_id !== selectedStep);\r\n                                                const reordered = stepEvents.map((e, i) => ({ ...e, position: i }));\r\n                                                setTempEvents([...otherEvents, ...reordered]);\r\n                                            }}\r\n                                        >\r\n                                            Remove\r\n                                        </button>\r\n                                    </div>\r\n                                ))}\r\n                        </div>\r\n                        {selectedStep !== null && (\r\n                            <div className=\"mb-1\">\r\n                                <button\r\n                                    className=\"btn btn-success\"\r\n                                    onClick={() => {\r\n                                        const stepEvents = tempEvents.filter(e => e.step_id === selectedStep);\r\n                                        const newEvent = {\r\n                                            id: -Date.now(),\r\n                                            name: \"New Event\",\r\n                                            step_id: selectedStep,\r\n                                            position: stepEvents.length\r\n                                        };\r\n                                        setTempEvents([...tempEvents, newEvent]);\r\n                                    }}\r\n                                >\r\n                                    Add event\r\n                                </button>\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n                    <div className=\"modal-footer\">\r\n                        <button\r\n                            className=\"btn btn-primary\"\r\n                            onClick={() => {\r\n                                setEvents(tempEvents);\r\n                                onClose();\r\n                            }}>\r\n                            Save\r\n                        </button>\r\n                        <button className=\"btn btn-danger\" onClick={onClose}>\r\n                            Cancel\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n"],"mappings":"gIAAA,MAAO,CAAAA,KAAK,KAAM,OAAO,CAEzB,OAASC,SAAS,CAAEC,QAAQ,KAAkC,OAAO,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAkBtE,cAAe,SAAS,CAAAC,iBAAiBA,CAAAC,IAAA,CAO/B,IAPgC,CACtCC,IAAI,CACJC,OAAO,CACPC,MAAM,CACNC,SAAS,CACTC,YAAY,CACZC,eACG,CAAC,CAAAN,IAAA,CACJ,KAAM,CAACO,UAAU,CAAEC,aAAa,CAAC,CAAGd,QAAQ,CAACS,MAAM,CAAC,CACpD,KAAM,CAACM,cAAc,CAAEC,iBAAiB,CAAC,CAAGhB,QAAQ,CAAgB,IAAI,CAAC,CAEzED,SAAS,CAAC,IAAM,CACZ,GAAIQ,IAAI,CAAEO,aAAa,CAACL,MAAM,CAAC,CACnC,CAAC,CAAE,CAACF,IAAI,CAAEE,MAAM,CAAC,CAAC,CAElB,GAAI,CAACF,IAAI,CAAE,MAAO,KAAI,CAEtB,mBACIL,IAAA,QAAKe,SAAS,CAAC,eAAe,CAACC,QAAQ,CAAE,CAAC,CAAE,CAACC,KAAK,CAAE,CAAEC,eAAe,CAAE,iBAAkB,CAAE,CAAAC,QAAA,cACvFnB,IAAA,QAAKe,SAAS,CAAC,cAAc,CAAAI,QAAA,cACzBjB,KAAA,QAAKa,SAAS,CAAC,eAAe,CAAAI,QAAA,eAC1BjB,KAAA,QAAKa,SAAS,CAAC,cAAc,CAAAI,QAAA,eACzBnB,IAAA,OAAIe,SAAS,CAAC,aAAa,CAAAI,QAAA,CAAC,sBAAoB,CAAI,CAAC,cACrDnB,IAAA,WAAQe,SAAS,CAAC,WAAW,CAACK,OAAO,CAAEd,OAAQ,CAAS,CAAC,EACxD,CAAC,cACNJ,KAAA,QAAKa,SAAS,CAAC,YAAY,CAAAI,QAAA,eACvBnB,IAAA,QAAKe,SAAS,CAAC,yBAAyB,CAAAI,QAAA,cACpCjB,KAAA,QAAKa,SAAS,CAAC,eAAe,CAAAI,QAAA,eAC1BjB,KAAA,WAAQa,SAAS,CAAC,aAAa,CAACM,KAAK,CAAEZ,YAAY,SAAZA,YAAY,UAAZA,YAAY,CAAI,EAAG,CAACa,QAAQ,CAAGC,CAAC,EAAKb,eAAe,CAACc,MAAM,CAACD,CAAC,CAACE,MAAM,CAACJ,KAAK,CAAC,CAAE,CAAAF,QAAA,eAChHnB,IAAA,WAAQ0B,YAAY,CAAC,EAAE,CAAAP,QAAA,CAAC,MAAI,CAAQ,CAAC,CACpC,CAAC,CAAC,CAAE,CAAC,CAAE,CAAC,CAAE,CAAC,CAAC,CAACQ,GAAG,CAACC,CAAC,eACf5B,IAAA,WAAgBqB,KAAK,CAAEO,CAAE,CAAAT,QAAA,CAAES,CAAC,CAAG,CAAC,EAAnBA,CAA4B,CAC5C,CAAC,EACE,CAAC,cACT5B,IAAA,UAAAmB,QAAA,CAAO,2BAAyB,CAAO,CAAC,EACvC,CAAC,CACL,CAAC,cACNnB,IAAA,QAAKe,SAAS,CAAC,yBAAyB,CAAAI,QAAA,CACnCV,YAAY,GAAK,IAAI,EAAIE,UAAU,CAC/BkB,MAAM,CAACN,CAAC,EAAIA,CAAC,CAACO,OAAO,GAAKrB,YAAY,CAAC,CACvCsB,IAAI,CAAC,CAACC,CAAC,CAAEC,CAAC,GAAKD,CAAC,CAACE,QAAQ,CAAGD,CAAC,CAACC,QAAQ,CAAC,CACvCP,GAAG,CAACQ,KAAK,eACNjC,KAAA,QAEIa,SAAS,CAAC,2EAA2E,CACrFqB,SAAS,MACTnB,KAAK,CAAE,CAAEoB,MAAM,CAAE,MAAO,CAAE,CAC1BC,WAAW,CAAEA,CAAA,GAAMxB,iBAAiB,CAACqB,KAAK,CAACI,EAAE,CAAE,CAC/CC,UAAU,CAAEjB,CAAC,EAAIA,CAAC,CAACkB,cAAc,CAAC,CAAE,CACpCC,MAAM,CAAEA,CAAA,GAAM,CACV,GAAI7B,cAAc,GAAK,IAAI,EAAIA,cAAc,GAAKsB,KAAK,CAACI,EAAE,CAAE,OAE5D,KAAM,CAAAI,YAAY,CAAGhC,UAAU,CAACiC,SAAS,CAACrB,CAAC,EAAIA,CAAC,CAACgB,EAAE,GAAK1B,cAAc,CAAC,CACvE,KAAM,CAAAgC,SAAS,CAAGlC,UAAU,CAACiC,SAAS,CAACrB,CAAC,EAAIA,CAAC,CAACgB,EAAE,GAAKJ,KAAK,CAACI,EAAE,CAAC,CAC9D,KAAM,CAAAO,OAAO,CAAG,CAAC,GAAGnC,UAAU,CAAC,CAC/B,KAAM,CAACoC,SAAS,CAAC,CAAGD,OAAO,CAACE,MAAM,CAACL,YAAY,CAAE,CAAC,CAAC,CACnDG,OAAO,CAACE,MAAM,CAACH,SAAS,CAAE,CAAC,CAAEE,SAAS,CAAC,CAEvC,KAAM,CAAAE,UAAU,CAAGH,OAAO,CAACjB,MAAM,CAACN,CAAC,EAAIA,CAAC,CAACO,OAAO,GAAKrB,YAAY,CAAC,CAClE,KAAM,CAAAyC,WAAW,CAAGJ,OAAO,CAACjB,MAAM,CAACN,CAAC,EAAIA,CAAC,CAACO,OAAO,GAAKrB,YAAY,CAAC,CACnE,KAAM,CAAA0C,SAAS,CAAGF,UAAU,CAACtB,GAAG,CAAC,CAACJ,CAAC,CAAEK,CAAC,GAAAwB,aAAA,CAAAA,aAAA,IAAW7B,CAAC,MAAEW,QAAQ,CAAEN,CAAC,EAAG,CAAC,CAEnEhB,aAAa,CAAC,CAAC,GAAGsC,WAAW,CAAE,GAAGC,SAAS,CAAC,CAAC,CACjD,CAAE,CAAAhC,QAAA,eAEFnB,IAAA,SAAAmB,QAAA,CAAOgB,KAAK,CAACkB,IAAI,CAAO,CAAC,cACzBrD,IAAA,WACIe,SAAS,CAAC,gBAAgB,CAC1BK,OAAO,CAAEA,CAAA,GAAM,CACX,KAAM,CAAA0B,OAAO,CAAGnC,UAAU,CAACkB,MAAM,CAACN,CAAC,EAAIA,CAAC,CAACgB,EAAE,GAAKJ,KAAK,CAACI,EAAE,CAAC,CACzD,KAAM,CAAAU,UAAU,CAAGH,OAAO,CAACjB,MAAM,CAACN,CAAC,EAAIA,CAAC,CAACO,OAAO,GAAKrB,YAAY,CAAC,CAClE,KAAM,CAAAyC,WAAW,CAAGJ,OAAO,CAACjB,MAAM,CAACN,CAAC,EAAIA,CAAC,CAACO,OAAO,GAAKrB,YAAY,CAAC,CACnE,KAAM,CAAA0C,SAAS,CAAGF,UAAU,CAACtB,GAAG,CAAC,CAACJ,CAAC,CAAEK,CAAC,GAAAwB,aAAA,CAAAA,aAAA,IAAW7B,CAAC,MAAEW,QAAQ,CAAEN,CAAC,EAAG,CAAC,CACnEhB,aAAa,CAAC,CAAC,GAAGsC,WAAW,CAAE,GAAGC,SAAS,CAAC,CAAC,CACjD,CAAE,CAAAhC,QAAA,CACL,QAED,CAAQ,CAAC,GAlCJgB,KAAK,CAACI,EAmCV,CACR,CAAC,CACL,CAAC,CACL9B,YAAY,GAAK,IAAI,eAClBT,IAAA,QAAKe,SAAS,CAAC,MAAM,CAAAI,QAAA,cACjBnB,IAAA,WACIe,SAAS,CAAC,iBAAiB,CAC3BK,OAAO,CAAEA,CAAA,GAAM,CACX,KAAM,CAAA6B,UAAU,CAAGtC,UAAU,CAACkB,MAAM,CAACN,CAAC,EAAIA,CAAC,CAACO,OAAO,GAAKrB,YAAY,CAAC,CACrE,KAAM,CAAA6C,QAAQ,CAAG,CACbf,EAAE,CAAE,CAACgB,IAAI,CAACC,GAAG,CAAC,CAAC,CACfH,IAAI,CAAE,WAAW,CACjBvB,OAAO,CAAErB,YAAY,CACrByB,QAAQ,CAAEe,UAAU,CAACQ,MACzB,CAAC,CACD7C,aAAa,CAAC,CAAC,GAAGD,UAAU,CAAE2C,QAAQ,CAAC,CAAC,CAC5C,CAAE,CAAAnC,QAAA,CACL,WAED,CAAQ,CAAC,CACR,CACR,EACA,CAAC,cACNjB,KAAA,QAAKa,SAAS,CAAC,cAAc,CAAAI,QAAA,eACzBnB,IAAA,WACIe,SAAS,CAAC,iBAAiB,CAC3BK,OAAO,CAAEA,CAAA,GAAM,CACXZ,SAAS,CAACG,UAAU,CAAC,CACrBL,OAAO,CAAC,CAAC,CACb,CAAE,CAAAa,QAAA,CAAC,MAEP,CAAQ,CAAC,cACTnB,IAAA,WAAQe,SAAS,CAAC,gBAAgB,CAACK,OAAO,CAAEd,OAAQ,CAAAa,QAAA,CAAC,QAErD,CAAQ,CAAC,EACR,CAAC,EACL,CAAC,CACL,CAAC,CACL,CAAC,CAEd","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}